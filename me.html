<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>

body{
font-family:Poppins;
background:#f0f2f5;
margin:0;
}

.dark{
background:#1e1e1e;
color:white;
}

/* LOGIN */

.login{
width:300px;
background:white;
margin:120px auto;
padding:30px;
border-radius:10px;
text-align:center;
box-shadow:0 5px 20px rgba(0,0,0,0.2);
}

input,button{
width:100%;
padding:10px;
margin:8px 0;
border-radius:6px;
border:1px solid #ccc;
}

button{
background:#0b5ed7;
color:white;
border:none;
cursor:pointer;
}

/* PANEL */

.panel{
display:none;
padding:20px;
}

/* DARK BUTTON */

.darkBtn{
position:fixed;
top:20px;
right:20px;
}

/* INVOICE */

.invoice{
width:210mm;
height:297mm;
background:white;
margin:auto;
padding:25px;
}

.dark .invoice{
background:#2c2c2c;
}

.header{
display:flex;
justify-content:space-between;
border-bottom:2px solid black;
}

.logo{
width:60px;
}

table{
width:100%;
border-collapse:collapse;
margin-top:15px;
}

table,th,td{
border:1px solid black;
}

th,td{
padding:8px;
text-align:center;
}

.sign{
display:flex;
justify-content:space-between;
margin-top:60px;
}

</style>
</head>

<body>

<!-- DARK MODE -->
<button class="darkBtn" onclick="toggleDark()">ðŸŒ™</button>

<!-- LOGIN -->

<div class="login" id="login">
<h3>Admin Login</h3>
<input type="password" id="pass">
<button onclick="login()">Login</button>
</div>

<!-- PANEL -->

<div class="panel" id="panel">

<input id="customer" placeholder="Customer Name">
<input id="phone" placeholder="Phone">
<input id="address" placeholder="Address">
<input id="gstRate" placeholder="GST %" value="18">

<button onclick="addRow()">Add Item</button>
<button onclick="generateBill()">Generate Bill</button>
<button onclick="downloadPDF()">Download PDF</button>
<button onclick="sendWhatsApp()">Send WhatsApp</button>

</div>

<!-- INVOICE -->

<div class="invoice" id="invoice">

<div class="header">

<div>
<img src="images/logo.png" class="logo">
<h2>M/S Tousif Power Solutions</h2>
<p>Malda, West Bengal</p>
<p>GSTIN: 19ABCDE1234F1Z5</p>
</div>

<div>
<p>Bill No: <span id="billNo"></span></p>
<p>Date: <span id="date"></span></p>
</div>

</div>

<h3>Customer Details</h3>
<p>Name: <span id="cName"></span></p>
<p>Phone: <span id="cPhone"></span></p>
<p>Address: <span id="cAddress"></span></p>

<table id="table">
<tr>
<th>Item</th>
<th>Qty</th>
<th>Price</th>
<th>Total</th>
</tr>
</table>

<h3>Tax Details</h3>
<p>CGST: â‚¹ <span id="cgst"></span></p>
<p>SGST: â‚¹ <span id="sgst"></span></p>

<h2>Grand Total: â‚¹ <span id="grand"></span></h2>

<div class="sign">
<div>Customer Signature</div>
<div>Authorized Signature & Seal</div>
</div>

</div>

<script>

/* LOGIN */

function login(){
if(pass.value==="TOUSIF"){
login.style.display="none";
panel.style.display="block";
}
else alert("Wrong Password");
}

/* DARK MODE */

function toggleDark(){
document.body.classList.toggle("dark");
}

/* SERIAL BILL */

let billNumber = localStorage.getItem("billNumber") || 1;

/* ADD ROW */

function addRow(){
let row = table.insertRow();

row.innerHTML=`
<td><input></td>
<td><input type="number"></td>
<td><input type="number"></td>
<td>0</td>
`;
}

/* GENERATE BILL */

function generateBill(){

let rows=document.querySelectorAll("#table tr");
let subtotal=0;

rows.forEach((row,i)=>{
if(i==0) return;

let qty=row.cells[1].children[0].value;
let price=row.cells[2].children[0].value;

let t=qty*price;
row.cells[3].innerText=t;
subtotal+=t;
});

let gstRateVal = gstRate.value;

let gst = subtotal * gstRateVal / 100;
let cgst = gst/2;
let sgst = gst/2;

let grand = subtotal + gst;

cgst.innerText=cgst.toFixed(2);
sgst.innerText=sgst.toFixed(2);
grand.innerText=grand.toFixed(2);

cName.innerText=customer.value;
cPhone.innerText=phone.value;
cAddress.innerText=address.value;

billNo.innerText="TPS-"+billNumber;
date.innerText=new Date().toLocaleDateString();

localStorage.setItem("billNumber",++billNumber);

/* CLOUD STORAGE */

let billData={
name:customer.value,
amount:grand
};

let history=JSON.parse(localStorage.getItem("history")||"[]");
history.push(billData);
localStorage.setItem("history",JSON.stringify(history));

}

/* PDF */

function downloadPDF(){
html2pdf().from(invoice).save("Invoice.pdf");
}

/* WHATSAPP */

function sendWhatsApp(){
let msg=Bill Generated - Amount â‚¹ ${grand.innerText};
window.open(https://wa.me/91${phone.value}?text=${msg});
}

</script>

</body>
</html>
